<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        
        <link rel="stylesheet" href="main.css" />
        
        <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>

        <script src="main.js"></script>
        <title>Extensions | LioranBoard</title>
    </head>
    <body>
        <header>
            <div class="title">
                <h1>LioranBoard Documentation</h1>
            </div>
            <div class="slide">
                <nav class="sidebar" id="sidebar">
                    <div class="scroller">
                        <dl>
                            <dt>
                                <a href="index.html"> About LioranBoard</a>
                            </dt>
                        </dl>

                        <dl>
                            <dt>
                                <a href="setup.html"> Basic Setup</a>
                            </dt>
                        </dl>

                        <dl>
                            <dt>
                                <a href="commands.html"> Commands</a>
                            </dt>
                        </dl>

                        <dl>
                            <dt>
                                <a href="faq.html"> FAQ</a>
                            </dt>
                        </dl>

                        <dl>
                            <dt>
                                <a href="extensions.html"  class="active"> Extensions</a>
                            </dt>
                            <dd>
                                <a class="sub-page" href="lbext.html">LioranBoard</a>
                            </dd>
                            
                            <dd>
                                <a class="sub-page" href="twitchext.html" >Twitch</a>
                            </dd>
                            <dd>
                                <a class="sub-page" href="externalext.html"  class="active">External</a>
                            </dd>
                            <dd>
                                <a href="#pollyTTS">
                                   Text to Speech Polly
                                </a>
                            </dd>
                            <dd>
                                <a href="#Spotify">
                                   Spotify
                                </a>
                            </dd>
                                  <dd>
                                <a href="#Lifx">
                                   LIFX
                                </a>
                            </dd>

                            <dd>
                                <a href="#Discordrelay">
                                   Discord Relay
                                </a>
                            </dd>

                            <dd>
                                <a href="#Googlesheets">
                                   Google Sheets
                                </a>
                            </dd>


                        </dl>

                        <dl>
                            <dt>
                                <a href="troubleshooting.html"> Troubleshooting</a>
                            </dt>
                        </dl>
                        <dl>
                            <dt>
                                <a href="commissions.html"> Commissions</a>
                            </dt>
                        </dl>
                    </div>
                </nav>
            </div>
        </header>

        <div class="wrapper">
            <div class="main">
                <section class="doc-content">
                    <h2>External Extensions</h2>

                   
                <p>Extensions that connect to external apps and services.</p>  
                
                             
                <h3 id="pollyTTS">Text to Speech Polly</h3>
                <p><b>Creator: </b>Christinna<br>
                <b>Download: <a href="https://christinna9031.itch.io/lioranboard-polly-text-to-speech">Itch.io</a></b><br>

                

                <b>Description: </b>

                Text to Speech extension using Amazon Polly service to turn any text into speech. <b>It works in OBS dock, browser source and external browsers.</b>   <br>
                <b>Preview:</b><br><iframe width="420" height="315"
                src="https://www.youtube.com/embed/wazxdYa8XN8?controls=1" allowfullscreen>
                </iframe><br>
                <b>Features:</b>    <br>
         
Text you wish to turn into speech can be sent directly from LioranBoard or your Transmitter (by entering the text or uploading a .txt file). <br>

You can set up your default voice, choosing either neural (more naturally sounding) or standard voice engine. All supported voices can be found <a href="https://docs.aws.amazon.com/polly/latest/dg/voicelist.html" target="_blank">here.</a>  <br> 
You can change pitch, speed and add some effects - you can make it whisper instead of speaking, or use DRC (dynamic range compression).<br>

You can configure a button that will automatically show currently played text. <br>

Playback controls: 
Play and Pause, Skip to Next/Play previous recording, Fast Forward/Backwards, Change Volume, Mute/Unmute.<br><br>
<b>Setup: </b>
<ol>
<li>You need AWS credentials to use this extension. If you do not have an Amazon account, you will need to <a href="https://aws.amazon.com/" target="_blank"> sign up</a> for one. Amazon will ask you to verify your identity by providing your phone number and payment method (credit or debit card, some prepaid cards work too). This is needed because AWS provides many other paid services, although we will be using Polly TTS as a part of their free tier. <br>
 Once you have your account, make sure you <a href="https://aws.amazon.com/activate/"> activated the services</a> and follow the steps <a href="https://aws.amazon.com/blogs/security/wheres-my-secret-access-key/" target="_blank">here</a> to get your credentials. As a safety precaution, you might want to <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/getting-started_create-admin-group.html" target="_blank">create an IAM user</a>, set up <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_users_change-permissions.html">their permissions</a> to be only able to access Polly TTS</a> and use their credentials instead. <button id="example" onclick="toggle_visibility('awskey')">Show example</button>
 <div id="awskey" style="display: none;"><img src="https://i.imgur.com/UC4cCaR.png" /><br /></div>
 </li>
 <li>Once you have your credentials, install the extension following these <a href="faq.html#installextensions" target="_blank">steps</a>. In your zip folder you should also see img and lib folders: 
    <ul>
    <li>
    Copy and paste the whole lib folder to the same folder where your Transmitter file resides (most likely in lioranboard folder). 
    <button id="example" onclick="toggle_visibility('lblibfolderx')">Show example</button>
    <div id="lblibfolderx" style="display: none;"><img src="https://i.imgur.com/6iMbTd9.png" /><br /></div></li>
    <li>Open the img folder, select all the images and copy them all to <code>lioranboard/LioranBoard Receiver(PC)/image</code> folder. </li>
</ul> 
</li>
<li>
In your Receiver, open the premade deck and click on the cogwheel button - edit commands:
<ul>
<li>aws_key = your Access Key ID (from step 1)</li>
<li>aws_secret = your Secret Access Key (from step 1)</li>
<li>voice = choose your default voice. N means it supports both standard and neural engine, NN means it only supports neural engine.</li>
<li>neural = switch between neural and standard engine</li>
<li>region = choose one closest to your location</li>
<li>button_id = button ID you wish to display currently played text (already pre-configured, do not need to change it)</li>
<li>length = max amount of characters per line, will format the displayed text in your button</li>
</ul>
<strong style="color:rgb(182, 2, 38)">Please make sure you do NOT wrap any of the parameters in double quotes.</strong>
<li>Refresh your Transmitter and click on Play Short examples button to test your credentials. A yellow notification message will pop up in your Receiver if something isn't set up right (follow its instructions). If your credentials are not accepted, go over the previous steps and refresh the Transmitter again. If you get a yellow message saying "Initialize the extension first", press the cogwheel button.</li>
<li>
If you are using the default LB notification system, you can follow the instructions in the Alternate Master Animator button to connect it to your new TTS extension. (will be released in the next LB version)
<button id="example" onclick="toggle_visibility('lbttsnotif')">Show example</button>
<div id="lbttsnotif" style="display: none;"><img src="https://i.imgur.com/Ib5jHeV.png" /><br /></div></li>
<li>Else you can set up your own TTS button triggers (the included example works for <code>!tts *</code> chat trigger).</li>
 <li>Sending a TTS command: </li>
    <ul>
        <li>type = Speak</li>
        <li>voice = default or select a specific one</li>
        <li>neural = switch between neural and standard engine</li>
        <li>pitch = change pitch (only works with standard engine)</li>
        <li>speed = how fast it should speak</li>
        <li>effect: whispered = whispers the text instead of speaking it (supported only by standard engine) <br>
                    drc = dynamic range compression. Makes it easier to hear in noisy environments. <br>
                    soft = makes the voice sound a bit softer (supported only by standard engine)</li>
        <li>value = text you want it to speak</li>

        </li>
    </ul>


 </ol>
<p>
 <b>Playback Controls</b><br>
 

 <ul><li> Play/Resume - play current recording or resume a currently paused one</li>
    <li>Pause - pause currently played recording</li>
<li>Play Previous - play previous recording</li>
<li>Skip to Next - skip to next recording. If there's a new TTS request in the queue, it will skip to that one instead.</li>
<li>Fast Forward/Backwards - you can choose the amount of seconds</li>
<li>Volume Up/Down - you can choose the increments, default is 10% per button press (only affects the TTS itself)</li>
<li>Mute/Unmute - Mutes/Unmutes your TTS (only affects the TTS itself)</li>
<li>Currently playing button - this button will automatically display a currently played TTS </li>
<button id="example" onclick="toggle_visibility('playbackx')">Show example</button>
<div id="playbackx" style="display: none;"><img src="https://i.imgur.com/TKPq0Mt.png" /><br /></div>
</ul>



<p>
<b>Additional Information</b><br>
All TTS requests are saved in your local storage, so you can safely come back and replay them later even after rebooting your computer. <br> 

Any new TTS request will start automatically playing after the last one finishes - there is an integrated queue system. If you're in the middle of replaying your old TTS recordings and a new request comes in, you can press the Skip to Next button to immediately start playing the new TTS request or wait for your current recording to finish first. 

You can press Clear Playlist button to delete all saved and current recordings in the queue. This will also automatically refresh your Transmitter.

You can send TTS requests from your Transmitter as well, either as text or by uploading a .txt file. This will use your default TTS settings. 

 

<p>
 <b>Important Notes</b><Br>
 Amazon Polly TTS has a <b>monthly limit</b> of 1 million neural and 5 million standard free characters for the first year of use. After that you can either switch to a new account to refresh the free tier or use a different TTS service. Make sure you keep track of what month you're on. More information can be found <a href="https://aws.amazon.com/polly/pricing/" target="_blank">here</a>. <br>

 To not go over the monthly limit (which is extremely generous unless you want it to read books for you), you can set up a <a href="https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/budgets-create.html" target="_blank">budget</a> to track and notify you of any extra costs.  <br>
 
 Do not share your AWS credentials or show them on your stream, as you might get billed if you or someone else accidentally uses any of the paid services. Amazon is quite lenient about this though, so you should be able to get a refund in the event something like this happens.  

            </p>

            <h3 id="Spotify">Spotify</h3>
            <p><b>Creator: </b>Christinna<br>
            <b>Download: <a href="https://christinna9031.itch.io/lioranboard-spotify">Itch.io</a></b><br>
        


            <b>Description: </b>

            Spotify extension for LioranBoard which allows you to display and control your Spotify playback directly from your Stream Deck.</b>   <br>
            <b>Preview:</b><br><iframe width="420" height="315"
            src="https://www.youtube.com/embed/EvPCpGzuypc?controls=1" allowfullscreen>
            </iframe><br>
            <b>Features:</b>    <br>
     
Displays your current track in your OBS overlay, StreamDeck and Transmitter.  <br>

Basic playback controls: Play/Pause, Next/Previous Track, Fast Forward/Backwards, Mute/Unmute, Volume Sliders, Like/Unlike track, Toggle Shuffle.  <br>

Song Request Queue: Adds a new song to the queue (either by its URL or a keyword) and displays the current song request queue in your OBS overlay. Everything updates automatically. There is a command to clear the queue as well.  <br>

Retrieve My Playlists: Retrieves all your (public) playlists and lets you play and cycle through them.  <br>

Search for Playlists by a tag : Retrieves playlists by tag/genre (for example romance, chill, jazz etc.).  <br>

Search for a song by keyword: Can search for a song by its name only or by its name and artist. You can cycle through all the results. <br></p>


<p><b>Prerequisites:</b><br> OBS Websocket 4.9, LioranBoard 1.42 or newer <br></p>
<p><b>Setup:</b>
<p>After downloading the .zip file, place the whole Spotify folder in your <code>lioranboard\LioranBoard Receiver(PC)\Ext</code> folder. Go to your Receiver and install the extension. It should automatically copy all the files, add a new deck and create a new Spotify OBS scene. If, for some reason, the image files do not get copied automatically, you can manually move them from the Spotify/img folder to your Receiver/image folder. <b>Unless the extension was not installed properly in the first place, you do not need to press 'Install Extension' button anymore.</b> <br>
As soon as you install the extension, you might get a popup message saying that your credentials are wrong. That is OK, it means it's trying to connect to Spotify, but we haven't set up the credentials yet. You should also have a new browser window  open where you need to <a href="https://christinna9031.github.io/LioranBoard-Files/Spotify_auth.html">authenticate your Spotify account</a>. Follow all the instructions and do not forget to refresh your Transmitter after setting up all parameters. <br>
Once your Spotify account is successfully linked, it should automatically show currently playing track in 3 separate locations: your Streamdeck, your Spotify scene in OBS and your Spotify tab in Transmitter. The Spotify tab in Transmitter contains some extra information about the current track. <br></p>
<p><strong style="color:rgb(182, 2, 38)"> Important Note: You must control your Spotify playback from within LioranBoard, otherwise it will not detect any playback changes, such as skipping to a next track. </strong></p>
<p> <img id="smallimg" src="https://i.imgur.com/02LT9qQ.png" ><b>INIT button</b> <br>
This button should be automatically initiated every time you restart your Transmitter. You can use it 'wake up' your Spotify extension, as it sometimes goes into sleep mode after some period of inactivity (you can also simply tap play in your Spotify player). <br>
Do not modify any commands here. 
Send to extension input fields: <br>
<ul>
<li><code>credentials</code> - credentials you obtained when you <a href="https://christinna9031.github.io/LioranBoard-Files/Spotify_auth.html">authenticated your Spotify account </a></li>
<li><code>refresh_token</code> - refresh token your obtained when you <a href="https://christinna9031.github.io/LioranBoard-Files/Spotify_auth.html">authenticated your Spotify account</a></li>
<li><code>last_track</code> - do not change</li>
<li><code>device_type </code> (optional) - device type you want to control your Spotify playback on. If set to default, it will pick the first one it can find.</li>
<li><code>device_id</code> (optional) - device ID you want to control your Spotify playback on. It should be displayed in your Spotify tab in your Transmitter. Can leavy empty if you do not have multiple devices of the same type.  </li>

<strong style="color:rgb(182, 2, 38)">Please make sure you do NOT wrap any of the parameters in double quotes. <br> Refresh your Transmitter whenever you make any changes to the parameters. Do NOT press the INIT button manually. </strong></ul>


<p><b>Basic Playback Controls</b> <br><img id="middleimg" src="https://i.imgur.com/c8VXkkU.png"><p>
    These should be pretty self-explanatory. <br>
    <b>Play:</b> 
    If <code>value</code> is empty, it will simply resume playing your current track. If <code>value</code> is a track/playlist/album URI, it will switch to playing that instead. <br>
    
    <b>Fast forward/backward</b>: <code>value</code> can be adjusted to how many seconds you want to fast forward/backward. </p>
    <p>

  
    <img style="width:8%;border:0px;vertical-align:middle;" src="https://i.imgur.com/traJ855.png">  <b>Add/Remove a track</b><br>
    Adds/Removes a currently playing track from your library. </p>

   <p> <img style="width:5%;border:0px;vertical-align:middle;" src="https://i.imgur.com/iVxGRST.png"> <b>Song Request </B><br>
     Default Twitch Chat trigger is <code>!sr *</code>. The wildcard accepts these formats: <br>
     <ul>
    <li>Spotify URI: <code>!sr spotify:track:4boaU9XaS1g6U1nV4lEsMl </code></li>
    <li>Spotify Link: <code>!sr https://open.spotify.com/track/4boaU9XaS1g6U1nV4lEsMl?si=mK4Bf7JiS0iMyX4kt57Gkg</code></li>
    <li>Keyword (song name only) <code>!sr Kiss from a rose</code></li>
    <li>Keyword (song name + artist name) <code>!sr Kiss from a rose # Seal</code>- artist name must follow the song name and '#' sign</li> 
         </ul>
    <p>Once you initiate the button, the extension will queue up the track in your Spotify player and add its name to a stack called <code>spotify_queue</code> (if the requested track cannot be found, the entry will be set to "error"). The SR button will then trigger another button which will display your current SR queue in your Streamdeck and your OBS overlay. Once Spotify starts playing the requested song, it will be automatically removed from the queue. <br>
        <img style="width:18%;border:0px;vertical-align:middle;" src="https://i.imgur.com/XbJEtvB.png">
    </p>

    <p><img style="width:5%;border:0px;vertical-align:middle;" src="https://i.imgur.com/5OvHX1H.png">  <b>Get My Playlists </b><br>
        This button will retrieve all your playlists (must be made public) and allow you to cycle through them using Previous/Next playlist button. The playlist URIs are by default saved in a spotify_playlists_uri stack. 


        </p>

        <p><img style="width:5%;border:0px;vertical-align:middle;" src="https://i.imgur.com/IWG0wNd.png">  <b>Playlists By Tags </b><br>
        You can search for playlists by tags. Press GET ALL TAGS button to retrieve all possible tags as it needs to be an exact match. You can then use Previous/Next playlist button to cycle through them. The playlist URIs are by default saved in a spotify_playlists_uri stack.  <br> 
        Default chat trigger is <code>!spotify tag *</code>, for example <code>!spotify tag instrumental</code>. 


        </p>

        <p><img style="width:5%;border:0px;vertical-align:middle;" src="https://i.imgur.com/MFcEvP1.png">  <b>Search by Keyword </b><br>
        Allows you to search for a song by its keyword. Default chat trigger is <code>!spotify search *</code> where the wildcard can be these two formats: 
        <ul>
            <li>Keyword (song name only) <code>!sr Kiss from a rose</code></li>
            <li>Keyword (song name + artist name) <code>!sr Kiss from a rose # Seal</code>- artist name must follow the song name and '#' sign</li>   
        </ul>
        <p>This will retrieve a stack called spotify_tracks_uri with all the matching tracks. The first matching track will be automatically queued up. You can use Next Search Result button to cycle through them. 

        </p>

        <p><img style="width:5%;border:0px;vertical-align:middle;" src="https://i.imgur.com/a0HIao5.png">  <b>Clear Queue </b><br>
        Experimental button. Should be able to clear your Spotify queue. If used while you have song requests in your queue, it will clear those as well. 
        This will temporarily mute your Spotify while the queue is being cleared and unmute it as soon as it's finished. <br>
        Note: Spotify does not natively offer this feature, so it might not always work 100%. 


        </p>

        <p><img style="width:12%;border:0px;vertical-align:middle;" src="https://i.imgur.com/mH8m5o9.png">  <b>Previous/Next X tracks </b><br>
            You can adjust this button to be able to go to your previous/next X amount of tracks. Just modify the repeat amount in the button. 

        </p>

</ul>

<h3 id="Lifx">LIFX</h3>
            <p><b>Creator: </b>Christinna<br>
            <b>Download: <a href="https://christinna9031.itch.io/lioranboard-lifx">Itch.io</a></b><br>
            <b>Description: </b>

            LIFX extension for LioranBoard which allows you and your viewers to fully control your LIFX lights straight from your StreamDeck.</b>   <br>
            <b>Preview:</b> On 100 bit donation play a fast rainbow.  Accomplished by running a loop that increments HUE += 20 every 800ms and then loops that 3 times for 3 cycles.<br><iframe  frameborder="0" width="455" height="252"
            src="https://clips.twitch.tv/embed?clip=NeighborlyExcitedBeefCurseLit-sYuoeGcY-_7Tka_m&parent=christinna9031.github.io&autoplay=false" allowfullscreen>
            </iframe></p><br>

           
                        
                
<style>
  
    table.lifx td {
    padding:2px 10px;
    margin:0px 0px;
    
    }
    .lifx code {
        padding:2px 4px;
       size:15px;
        margin: 2px; 
        white-space: pre-wrap;       
        word-wrap: break-word;       
    }

    table.lifx td:first-child{
    width:130px;
    }

    table.lifx td:last-child {
    width:130px;
    }


  
    </style>

<p><b>Setup:</b>
<p>You will find a premade INIT button in your deck. Right click on it - Edit commands. 
<img src="https://i.imgur.com/MWdMXB7.png"> <br>
The <code>name</code> value will be your LIFX token which you can retrieve <a href="https://cloud.lifx.com/settings" target="_blank">here</a>. The <code>power_off</code> can be set to true to receive a yellow notification message each time your request is successful, or set to false to only receive error notifications.  </p>
<p>

  INIT, Get Light, Toggle Power, Effects Off, Activate Scene, Clean Mode and Validate Color can be all found under a single extension name <b>LIFX Basics</b>. If the particular input box is not mentioned in the documentation below, it means the command will ignore its value.  </b>
</p>
   <p>
<b>Selectors</b><br>
Selectors are identifiers for addressing one or many lights belonging to the authenticated account. <Br>

Selectors which generally specify multiple lights, <code>all</code>, <code>group</code>, <code>group_id</code>, <code>location</code>, <code>location_id</code>, and <code>scene_id</code>, accept an optional suffix <code>:random</code> which specifies a single random light from that set of lights. e.g. <code>all:random</code>, <code>group:[value]:random</code>, <code>location_id:[value]:random</code>. <br>

    You can combine up to 25 selectors together additively by separating them with <code>,</code>, so if you want to address both a light labelled "Bedroom" and a light labelled "Office", you can use <code>label:Bedroom,label:Office</code> as the selector.

<table>
<tr>
<td><b>Selector</b></td>
<td><b>Description</b></td>
</tr>
<tr>
    <td>label:[value]</td>
    <td>Lights that match the label.</td>
    </tr>
    <tr>
        <td>id:[value]</td>
        <td>The light with the given id/serial number. Returns a list of one light.</td>
        </tr>
        <tr>
            <td>group_id:[value]</td>
            <td>The lights belonging to the group with the given ID</td>
            </tr>
            <tr>
                <td>group:[value]</td>
                <td>The lights belonging to the groups matching the given label</td>
                </tr>
                <tr>
                    <td>location_id:[value]</td>
                    <td>The lights belonging to the location matching the given ID</td>
                    </tr>
                    <tr>
                        <td>location:[value]</td>
                        <td>The lights belonging to the locations matching the given label</td>
                        </tr>
                        <tr>
                            <td>scene_id:[value]</td>
                            <td>The lights that are referenced in the scene with the given ID</td>
                            </tr>
                            <tr>
                                <td></td>
                                <td></td>
                                </tr>


    
</table>


    <p> </p>
    <table class="lifx">
    <tr>
    <td><b>Command</b></td>
    <td><b>Input</b></td>
    <td><b>Description</b></td>
    <td><b>Example</b></td>
    </tr>
    <tr>
    <td><b>INIT</b></td>
    <td>Name</td>
    <td>Your LIFX token (can be retrieved <a href="https://cloud.lifx.com/settings" target="_blank">here</a>)</td>
    <td>657sdf657j6w64yt</td>
    </tr>
    <tr>
        <td></td>
        <td>Power_off</td>
        <td>Set to true if you wish to receive a notification after a successful request. If set to false, only error notifications will be received.</td>
        <td>True</td>
        </tr>
  
    <tr>
        <td><b>Get Light</b></td>
    <td>Name</td>
    <td>Label or id of your light. Has to include the selector: <code>label:</code> for label or <code>id:</code> for id.</td>
    <td>label:My Light</td>
    </tr>
    <tr>
        <td><b></b></td>
    <td></td>
    <td>This command will create a stack <code>lifx</code> containing information about a single light device.</td>
    <td></td>
    </tr>


    <tr>
    <td><b>Toggle Power</b></td>
    <td>Name</td>
    <td>Selector to limit which lights are toggled. Must include the selector itself. </td>
    <td>location:kitchen</td>
    </tr>
    <tr>
    <td></td>
    <td>Duration</td>
    <td>The time in seconds to spend performing the power toggle.</td>
    <td>10</td>
    </tr>
    <tr>
    <td><b>Effects Off</b></td>
    <td>Name</td>
    <td>Selector to limit which lights this applies to. </td>
    <td>group:My Lights</td>
    </tr>
    <tr>
    <td></td>
    <td>Power_off</td>
    <td>If true, the devices will also be turned off.</td>
    <td>true</td>
    </tr>
    <tr>
    <td><b>Activate Scene</b></td>
    <td>Name</td>
    <td>Name of the scene.</td>
    <td>My Scene</td>
    </tr>
    <tr>
    <td></td>
    <td>Duration</td>
    <td>Time in seconds to transition from the current light state to the scene state.</td>
    <td>10</td>
    </tr>
    <tr>
    <td></td>
    <td>Ignore</td>
    <td>Any of power, infrared, duration, intensity, hue, saturation, brightness or kelvin, specifying that these properties should not be changed on devices when applying the scene.</td>
    <td>power,duration</td>
    </tr>
        <tr>
    <td></td>
    <td>Fast</td>
    <td>Execute the query fast, without initial state checks and wait for no results.</td>
    <td>False</td>
    </tr>
   
    <tr>
        <td><b>Clean Mode</b></td>
        <td>Selector</td>
        <td>Selector to limit which lights are switched to clean mode. </td>
        <td>id:d3b2f2d97452</td>
        </tr>
        <tr>
        <td></td>
        <td>Power_off</td>
        <td>Whether you want to turn off the device.</td>
        <td>false</td>
        </tr>
        <tr>
        <td></td>
        <td>Duration</td>
        <td>Duration in seconds (0 sets the default duration for the device).</td>
        <td>10</td>
        </tr>
               <tr>
            <td><b>Validate Color</b></td>
            <td>Name</td>
            <td>Color you wish to validate. See all possible colors <a href="https://api.developer.lifx.com/docs/colors">here</a>. A yellow success notification in your Receiver means the color format is correct. </td>
            <td>#03fcec</td>
            </tr>

            <tr>
                <td><b>Set State</b></td>
                <td>Selector</td>
                <td>Selector to limit which lights are toggled. Must include the selector itself. </td>
                <td>label:Fish Tank</td>
                </tr>
                <tr>
                    <td></td>
                    <td>Power_on</td>
                    <td>If true, turn the bulb on if it is not already on.</td>
                    <td>true</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Color</td>
                        <td>The <a href="https://api.developer.lifx.com/docs/colors">color</a> to set the light to.</td>
                        <td>blue</td>
                        </tr>
                <tr>
                <td></td>
                <td>Brightness</td>
                <td>The brightness level from 0.0 to 1.0. Overrides any brightness set in color (if any).</td>
                <td>0.5</td>
                </tr>
                <tr>
                <td></td>
                <td>Duration</td>
                <td>How long in seconds you want the power action to take. Range: 0.0 – 3155760000.0 (100 years)</td>
                <td>60</td>
                </tr>
                <tr>
                <td></td>
                <td>Infrared</td>
                <td>The maximum brightness of the infrared channel from 0.0 to 1.0.</td>
                <td>0.5</td>
                </tr>
                <tr>
                    <td></td>
                    <td>Fast</td>
                    <td>Execute the query fast, without initial state checks and wait for no results.</td>
                    <td>False</td>
                    </tr>

           
            <tr>
                <td><b>Breathe Effect</b></td>
                <td>Selector</td>
                <td>Selector to limit which lights will run the effect. Must include the selector itself. </td>
                <td>label:Aquarium</td>
                </tr>
                <tr>
                <td></td>
                <td>Power_on</td>
                <td>If true, turn the bulb on if it is not already on.</td>
                <td>True</td>
                </tr>
                <tr>
                <td></td>
                <td>Color</td>
                <td>The <a href="https://api.developer.lifx.com/docs/colors">color</a> to use for the breathe effect.</td>
                <td>Red</td>
                </tr>
                <tr>
                <td></td>
                <td>Color_from</td>
                <td>The <a href="https://api.developer.lifx.com/docs/colors">color</a> to start the effect from. If this parameter is omitted, the color the bulb is currently set to is used instead.</td>
                <td>rgb:0,255,255</td>
                </tr>
                <tr>
                <td></td>
                <td>Persist</td>
                <td>If false, set the light back to its previous value when effect ends. If true, leave the last effect color.</td>
                <td>True</td>
                </tr>
                <tr>
                <td></td>
                <td>Peak</td>
                <td>Defines where in a period the target color is at its maximum. Minimum 0.0, maximum 1.0.</td>
                <td>0.5</td>
                </tr>
                    <tr>
                <td></td>
                <td>Period_cycles</td>
                <td>Period - the time in seconds for one cycle of the effect. Cycles - the number of times to repeat the effect. <br>Two values separated by a comma. Put in a letter (like X) if you do not wish to change one of the values.  </td>
                <td>5,10 <br> 
                X,10</td>
                </tr>

                <tr>
                    <td><b>Flame Effect</b></td>
                    <td>Selector</td>
                    <td>Selector to limit which devices will run the effect. Must include the selector itself. </td>
                    <td>label:Desk</td>
                    </tr>
                    <tr>
                <td></td>
                <td>Power_on</td>
                <td>Switch any selected device that is off to on before performing the effect.</td>
                <td>True</td>
                </tr>
                    <tr>
                    <td></td>
                    <td>Period</td>
                    <td>This controls how quickly the flame runs. It is measured in seconds. A lower number means the animation is faster.</td>
                    <td>5</td>
                    </tr>
                    <tr>
                    <td></td>
                    <td>Duration</td>
                    <td>How long the animation lasts for in seconds. Not specifying a duration makes the animation never stop. Specifying 0 makes the animation stop.</td>
                    <td>30</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Fast</td>
                        <td>Execute the query fast, without initial state checks and wait for no results.</td>
                        <td>False</td>
                        </tr>
          <tr>
                    <td><b>Morph Effect</b></td>
                    <td>Selector</td>
                    <td>Selector to limit which lights are toggled. Must include the selector itself. </td>
                    <td>Location:Bedroom</td>
                    </tr>
                      <tr>
                <td></td>
                <td>Power_on</td>
                <td>Switch any selected device that is off to on before performing the effect.</td>
                <td>true</td>
                </tr>
                    <tr>
                    <td></td>
                    <td>Period</td>
                    <td>This controls how quickly the morph runs. It is measured in seconds. A lower number means the animation is faster</td>
                    <td>5</td>
                    </tr>
                    <tr>
                    <td></td>
                    <td>Duration</td>
                    <td>How long the animation lasts for in seconds. Not specifying a duration makes the animation never stop. Specifying 0 makes the animation stop. </td>
                    <td>10</td>
                    </tr>
                    <tr>
                    <td></td>
                    <td>Palette</td>
                    <td>You can control the colors in the animation by specifying a list of color specifiers separated by commas.</td>
                    <td>red, blue, #ff0000 </td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Fast</td>
                        <td>Execute the query fast, without initial state checks and wait for no results.</td>
                        <td>False</td>
                        </tr>

                        <td><b>Move Effect</b></td>
                        <td>Selector</td>
                        <td>Selector to limit which lights are toggled. Must include the selector itself. </td>
                        <td>Label:Desk Lamp</td>
                        </tr>
                               <tr>
                <td></td>
                <td>Power_on</td>
                <td>Switch any selected device that is off to on before performing the effect.</td>
                <td>True</td>
                </tr>
                        <tr>
                        <td></td>
                        <td>Direction</td>
                        <td>Move direction, can be forward or backward.</td>
                        <td>Forward</td>
                        </tr>
                        <tr>
                        <td></td>
                        <td>Period</td>
                        <td>The time in seconds for one cycle of the effect.</td>
                        <td>10</td>
                        </tr>
                        <tr>
                        <td></td>
                        <td>Cycles</td>
                        <td>The number of times to move the pattern across the device. Special cases are 0 to switch the effect off, and unspecified to continue indefinitely.</td>
                        <td>10</td>
                        </tr>
                         <tr>
                        <td></td>
                        <td>Fast</td>
                        <td>Execute the query fast, without initial state checks and wait for no results.</td>
                        <td>False</td>
                        </tr>
                            <td><b>Pulse Effect</b></td>
                            <td>Selector</td>
                            <td>Selector to limit which lights are toggled. Must include the selector itself. </td>
                            <td>group:my tank</td>
                            </tr>
                            <tr>
                                <td></td>
                                <td>Power_on</td>
                                <td>Switch any selected device that is off to on before performing the effect.</td>
                                <td>True</td>
                                </tr>
                            <tr>
                            <td></td>
                            <td>Color</td>
                            <td>The <a href="https://api.developer.lifx.com/docs/colors">color</a> to use for the pulse effect.</td>
                            <td>blue</td>
                            </tr>
                            <tr>
                            <td></td>
                            <td>From_color</td>
                            <td>The <a href="https://api.developer.lifx.com/docs/colors">color</a> to start the effect from. If this parameter is omitted, the color the bulb is currently set to is used instead.</td>
                            <td>#ff0000</td>
                            </tr>
                            <tr>
                            <td></td>
                            <td>Period</td>
                            <td>The time in seconds for one cycle of the effect.</td>
                            <td>2</td>
                            </tr>
                            <tr>
                            <td></td>
                            <td>Cycles</td>
                            <td>The number of times to repeat the effect.</td>
                            <td>10</td>
                            </tr>
                                <tr>
                            <td></td>
                            <td>Persist</td>
                            <td>If false, set the light back to its previous value when effect ends. If true, leave the last effect color.</td>
                            <td>False</td>
                            </tr>
                          

                                <tr>
                                    <td><b>State Delta</b></td>
                                    <td>Selector</td>
                                    <td>Selector to limit which lights are toggled. Must include the selector itself. </td>
                                    <td>group:Desk lights</td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td>Power_on</td>
                                        <td>Switch any selected device that is off to on before performing the effect.</td>
                                        <td>true</td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td>Fast</td>
                                            <td>Execute the query fast, without initial state checks and wait for no results.</td>
                                            <td>False</td>
                                            </tr>
                                    <tr>
                                    <td></td>
                                    <td>Duration</td>
                                    <td>How long in seconds you want the power action to take. Range: 0.0 – 3155760000.0 (100 years).</td>
                                    <td>60</td>
                                    </tr>
                                    <tr>
                                    <td></td>
                                    <td>Infrared</td>
                                    <td>The maximum brightness of the infrared channel from 0.0 to 1.0.</td>
                                    <td>0.5</td>
                                    </tr>
                                    <tr>
                                    <td></td>
                                    <td>Kelvin</td>
                                    <td>Change the kelvin by this amount. The resulting kelvin is clipped to [2500, 9000].</td>
                                    <td>7000</td>
                                    </tr>
                                        <tr>
                                    <td></td>
                                    <td>Hue_sat_brightness</td>
                                    <td>Hue: Rotate the hue by this angle in degrees. Range: -360.0 – 360.0 degrees<br>
                                        Saturation: Change the saturation. Between 0.0 and 1.0. <br>
                                        Brightness: Change the brightness. Between 0.0 and 1.0. <br>
                                        All 3 values need to be separated by comma: <code>hue, saturation, brightness</code>. <br> Put in a letter (like X) if you do not wish to change one of the values.
                                    </td>
                                    <td>50,0.5,1.0 <br> 50,X,0.2  </td>
                                    </tr>
    </table>

    <h3 id="Discordrelay">Discord Relay</h3>
            <p><b>Creator: </b>Christinna<br>
            <b>Download: <a href="https://christinna9031.itch.io/lioranboard-discord-twitch-relay">Itch.io</a></b><br>
            <b>Description: </b>

            Discord relay is an extension which lets you relay messages from Discord to Twitch and from Twitch to Discord. It can also enable Discord message triggers for LioranBoard. </b>   <br>
            <b>Preview:</b><br><iframe width="420" height="315"
            src="https://www.youtube.com/embed/Qn1puWHfMYs?controls=1" allowfullscreen>
            </iframe><br></p>
            <p><b>How it works</b><br>
            The extension utilizes both Discord webhook and Discord websocket (which you connect to with a bot token). Your Discord websocket is listening to all Discord chat messages and tells the extension to relay them to your Twitch chat (by using the already existing connection in your Transmitter). <Br> The extension listens to all Twitch chat messages, fires a Discord webhook every 2 seconds and posts them in your Discord channel as either embeds or plain text. <br>
            Since the Discord websocket already listens to all your Discord messages, I implemented a feature that automatically converts them to the same payload Twitch chat uses and sends them to LioranBoard. This means you can use chat triggers from Discord in your LioranBoard. You can also configure which Discord server roles correspond to specific Twitch badges (broadcaster, mod, subscriber, vip).<br>
            When the relay is open, it automatically starts storing and regularly updating all your current Twitch chatters profile image URLs. It can then display their icon in the relayed messages on Discord. <br>
            I have also set up a simple AWS API service which can retrieve all your Discord server emojis and save them into .ini file (this cannot be done from your Transmitter due to CORS and Cloudfare blocking the access). This helps the extension to convert Twitch emojis to Discord emojis and correctly display them when relaying messages from Twitch. <br>
            </p>
            <p><b>Setup:</b> </p>
            <ul>
            <li><p><b>Install the extension:</b> Follow <a href="https://christinna9031.github.io/LBDocumentation/setup.html#extensions">this link</a> to properly install the extension.</p></li>

             
            <li><p><b class="btnbasic" id="btnpurple">Set Params</b> </p><p>You should see a new premade deck in your Receiver. We will need to edit all the values in the <b>'set params' button</b>. Right click on the button - Edit commands: </li>
                <strong style="color:rgb(182, 2, 38)">Please make sure you wrap ALL the parameters below (except for dc_server) in DOUBLE QUOTES.</strong>
            <p></p>
            <ol>
            <li>Fill out your <b>twitch channel name</b> (example: Dashducks). This is where all the Discord messages will be sent to. This is also the channel our relay will be listening to and relaying messages to Discord. You have to be already connected to it (use <a href="https://christinna9031.github.io/LBDocumentation/twitchcommands.html#twitchjoinchannel">Twitch: Join Channel</a> command if needed).</li>
            <li>
        <b>Enable developer mode in Discord: </b>Open your Discord settings (the next to your name at the bottom left) and click on Appearance. There you will find Developer Mode. Click the toggle to enable it.
            </li>
            <li><b>Retrieve your Discord server ID: </b>Right click on the sidebar icon of your server - copy ID and paste it in the dc_server value.  </li>
            <li><b>Create a webhook for the Discord channel you want to relay Twitch chat messages to: </b>Right click on channel - Edit channel - integrations - Create Webhook. Copy its URL and paste it in the dc_webhook value. </li>
            <li><b>Create an application in Discord Developer Portal:</b></li>
             <ul>
            <li>
            Open this link: <a href="https://discord.com/developers/applications">https://discord.com/developers/applications.</a>
            </li>    
            <li>Click on 'New Application' button.  <button id="example" onclick="toggle_visibility('relayx')">Show example</button>
            <div id="relayx" style="display: none;"><img src="https://i.imgur.com/kWz3z2B.png" /><br /></div> </li>
            <li>Give it a name.</li>
            <li>After it is created, click on 'Bot' in the left side menu. Click on 'Add Bot' button and click on 'Yes, do it!' button. <br>
           <i>If you get 'Too many users have this username, please try another.' error, try changing your application name to something less generic.</i>    <button id="example" onclick="toggle_visibility('relayx1')">Show example</button>
            <div id="relayx1" style="display: none;"><img src="https://i.imgur.com/C1Z58xR.png" /><br /></div></li> 
            <li>Once your bot is created, click on 'Click to reveal token' link, copy the token and paste it in the bot_token value. All other settings should be left at default.
            <button id="example" onclick="toggle_visibility('relayx2')">Show example</button>
            <div id="relayx2" style="display: none;"><img src="https://i.imgur.com/MkOH8QQ.png" /><br /></div></li>
            <li>Click on 'OAuth2' in the side menu and check 'bot' in the scopes list. This will open up a new menu below where you need to check 'Read Message History'. Remember this is only for reading messages, so your bot does not need any other permissions.</li>
            <li>Scroll up a bit and click on 'Copy'. Open the link in a new browser window and invite the bot to your Discord channel. You can restrict your bot to only see certain channels, otherwise it will be relaying messages from all the channels it can see on your server.  <button id="example" onclick="toggle_visibility('relayx5')">Show example</button>
                <div id="relayx5" style="display: none;"><img src="https://i.imgur.com/skfzXnr.png" /><br /></div></li>
          </ul>  
          <li><p>Click Done in your button commands screen. You can now (optionally) modify roles and ignore button and retrieve your Discord emojis (read below). Once you're done editing those, you can press the 'set params' button. It should now be initiated every time you connect to the Transmitter, so you will only need to manually open the relay connection.  </li>  
     
           </ol>

        <li><b class="btnbasic" id="btnaqua">Roles</b> </p>
        <p>This button stores the relation between your Discord roles and Twitch badges (broadcaster, mod, sub etc.). What is it for? This extension can convert your Discord posts to regular Twitch chat triggers you use in LioranBoard. <br>
        Right click on the button - Edit commands. There are already pre-filled values including broadcaster, mod, subscriber and vip. All you need to do is change the role ID. Do not modify anything else. 
        You can retrieve your role ID by going to your Discord server settings - Roles, right clicking on the role name and pressing 'Copy ID' button. Replace the pre-filled ID with your own. Make sure to keep the formatting: <code>"badgename:ROLEID"</code>
            <button id="example" onclick="toggle_visibility('relayx3')">Show example</button>
            <div id="relayx3" style="display: none;"><img src="https://i.imgur.com/dbY7kOW.png" /><br /></div>
         </p></li>

       <li>  <p><b class="btnbasic" id="btnaqua">Ignore</b> 
      <p>  You can add any names you do not want to relay the messages from. For example, you might not want to relay messages from your bot accounts. </li>

     <li>   <p><b class="btnbasic" id="btnaqua">Discord Emojis</b> </p>
        <p>This button should retrieve all your custom Discord emojis and save them in <code>DiscordEmojis.ini</code> file in your Receiver folder. If your Twitch viewers use any of the same emojis in the Twitch chat, they will be auto converted and properly displayed in your relayed messages to Discord. <br>
        Do not edit anything in this button. Simply press it and it should do all the work for you. If you decide to make any changes in your .ini file, do not press the button again as it will override any changes you made. </p>
       <p> Note: If your <b>Twitch emojis do not match the Discord ones</b> (= they have a different name), you can open the DiscordEmojis.ini file and manually edit the Twitch emojis part. <br>
        For example, you have a subscriber emoji on Twitch called 'RamsreLord', but your Discord custom emoji's name is 'RamsreFish'. After pressing the button and opening the DiscordEmojis.ini file, the emoji will be stored as <code>'RamsreFish=RamsreFish:EMOJIID'</code>. You want to change the first 'RamsreFish' to 'RamsreLord' as this is the Twitch emoji name which the extension will look for to replace it with the Discord emoji ID.     <button id="example" onclick="toggle_visibility('relayx4')">Show example</button>  <div id="relayx4" style="display: none;"><img src="https://i.imgur.com/DCXkCCZ.png" /><br /></div>
       

       <p> <b style="color:red">IMPORTANT:</b> The API cannot see <b>Discord emojis you did not upload yourself manually.</b> If your Discord server emojis come from linking your Discord to your Twitch channel, they will not show up in the list. You can fix this in two ways: 
        <ol>
        <li>Manually reupload all the externally linked emojis on your Discord server and press the Discord Emojis button again. They should now all show up in your DiscordEmojis.ini file.</li>
        <li>Manually change the DiscordEmojis.ini file to add your externally linked emojis: <br>
        <ol>
        <li>In your Discord server, insert the emoji you want to add in the message window, type <code>:\</code> before the emoji and hit enter. The emoji will be displayed as <code><:EMOJI_NAME:ID></code>.</li>
        <li>Add a new category (if it doesn't exist already) <code>[default_emojis]</code> to your DiscordEmojis.ini file. </li>
        <li>Add a new line to your DiscordEmojis.ini file in this format: [number]="TWITCH_EMOJI_NAME=DISCORD_EMOJI_NAME:DISCORD_EMOJI_ID". (remember to start from 0)</li>
        <li>Add or change size to reflect the amount of new emojis you added. For example, <code>size="1"</code> if you have a single emoji. Save the file. </li>
        <li>Restart your Transmitter or press relay close, set params and open relay button again. </li>
        <li>Your newly added emojis should now be correctly displayed.</li>
        </ol> 
        <button id="example" onclick="toggle_visibility('relayeditemojis')">Show video guide</button>
        <div id="relayeditemojis" style="display: none;"> <div class="video"><iframe 
            src="https://www.youtube.com/embed/vogpZb7WXoY?controls=1" allowfullscreen></iframe></div>
            </iframe><br></div>
        </li>
        </ul>

    </li></ul>
</li>            </ol>

    <p><b class="btnbasic" id="btngreen">Relay Open</b> </p> <p>Pressing this button will connect you to Discord and start relaying messages between Discord and Twitch. You should see a yellow notification message 'Connected to Discord! Listening to messages' (you can also check the connection status in your Transmitter - Discord Relay tab). Please note that you need to be already connected to Twitch chat with the channel you specified in your 'set params' button.  
    If you click on the button - Edit commands, you can edit the following values: 
    <ul>
    <li>
    <b>status</b> - enable, disable, triggers only 
    </li>    
    <li>
    <b>oauth_token</b> - your Twitch token. Should be already pre-filled, no need to change it.  
    </li>
    <li><b>discord_trigger</b> - whether you want to enable Discord chat message triggers</li>
    <li><b>discord_mode</b> - pretty (each relayed Twitch chat message will be embed displaying the viewer's profile picture and the sidebar will match the user's Twitch color) vs. simple (all relayed messages are posted as plain text). <br>Please note that there's a limit to how many messages and embeds the webhook can send. If your Twitch chat gets spammed with a lot of messages, it will automatically switch to simple mode to keep up.  </li>
    </ul>
    </li>
    <p><b class="btnbasic" id="btnred">Relay Close</b> </p><p>Pressing this button will disconnect you from Discord and stop relaying messages. </li>
     <p><b class="btnbasic" id="btnblue">Relay Trigger Only</b> </p> <p>Pressing this button will connect you to Discord and start listening to Discord chat triggers only (will not relay messages). These triggers will be converted to your regular Twitch chat triggers (including roles converted to badges, so you can make a button that only a 'mod' role can trigger). There is a '!test from Discord' button to demonstrate how to use it. Just type !test in your Discord channel after pressing the button and it should trigger it. This acts like a regular Twitch chat trigger and supports both wild cards and Math: Trigger pull command.          <button id="example" onclick="toggle_visibility('relayx6')">Show example</button>
        <div id="relayx6" style="display: none;"><img src="https://i.imgur.com/G6xlPLE.png" /><br /></div> </li></ul>

     <p>Note: If you use 'Relay Open' or 'Relay Trigger only' button, you should see your Discord bot online in your server. That means it is ready and listening to messages. You can restrict your bot to only see certain channels by manually removing its channel read permissions, otherwise it will be relaying messages from all the channels it can see. </p>

 
     <div id="relayx4" style="display: none;"><img src="https://i.imgur.com/DCXkCCZ.png" /><br /></div>

     <h3 id="Googlesheets">Google Sheets</h3>
     <p><b>Creator: </b>Christinna<br>
     <b>Download: <a href="https://christinak.itch.io/lb-google-sheets">Itch.io</a></b><br>
     <b>Description: </b>
     Google Sheets is an extension which lets you retrieve and modify data in your Google Sheets.  <br>
     <b>Available commands:</b>  
    <ul><li>Get Data, Append Data, Update Data, Batch Update, Find Data, Copy Paste, Clear Data </li>
    <li>Auto Fill, Auto Sort, Randomize, Find and replace, Delete Duplicates, Split text into columns </li>
    <li>Merge Cells, Unmerge Cells, Insert Range, Delete range</li>
    <li>Create Spreadsheet, Duplicate Sheet, Add Sheet</li></ul>
    <h4>Important to know</h4>
    <ul>
    <li>
    The extension only works with public spreadsheets specifically created with it (<a href="https://i.imgur.com/JMjvPyX.mp4">video guide on how to make a spreadsheet public</a>). It cannot read or modify any of your other files. </li>
    <li>Your read quota is 60 requests/minute and you do not share it with other extension users. There is no daily limit. </li>
    <li>Your write quota is 30 requests/minute (you can send batch requests that count as 1 request) and you share it with other extension users. Total quota is 300 requests/minute. The extension assumes there will be no more 10 users making 30 write requests per minute at the same time. There is no daily limit. </li> 
    </ul>
     <h4>How it works</h4><p>
     The extension utilizes Google Sheets API endpoints to read and write data. <br>
     While reading data is easy, as it only requires an API key, writing data is more complex. The extension ulitizes a custom made API to retrieve your refresh token, as this is only possible server-side and cannot be done from your Transmitter.  <br>
     <b>Important:</b> This extension can only modify public spreadsheets that have been previously created with it. It cannot modify or delete any of your other Drive files. 
     <p><i>Note for other devs: If you would like to use your own project credentials instead, you will need a bit of Google Cloud and JS coding knowledge, but it is possible to edit the extension for this purpose. I have added comments inside the .lbe file on what modifications to make and some very basic explanation on how to retrieve your refresh token. </i> </p>
     </p>
     <p><h4>Setup</h4> </p>
     <button id="example" onclick="toggle_visibility('setupsheets')">Show all steps</button>    
     <div id="setupsheets"  style="display:none"> 
     <ol>
     <li><b>Install the extension:</b> Follow <a href="https://christinna9031.github.io/LBDocumentation/setup.html#extensions">this link</a> to properly install the extension.</li>
     <li><b>Configure INIT button:</b> You should see a new premade deck in your Receiver. Right click on the red INIT button - edit commands. Scroll down to the Send to extension command and fill out the following fields: (if you cannot see them, reinstall the extension and refresh your Transmitter). </li>
        <ul>
         <li>
        <b>refreshToken</b> - you need to allow the extension to access your Google Sheets and retrieve the refresh token. Please follow <a href="https://accounts.google.com/o/oauth2/v2/auth?client_id=772733629610-952dp5qu1gm9802ka1t6f73o6u8m7drn.apps.googleusercontent.com&redirect_uri=https://christinna9031.github.io/LioranBoard-Files/sheetsauth.html&response_type=code&scope=https://www.googleapis.com/auth/drive.file&access_type=offline&prompt=consent" target="_blank">this link</a> and all its instructions after you get redirected. <br> Note: This will allow the extension to read and modify only files that have been previously created with it. It does not have permissions to do anything else. 
         </li>   
         <li>
        <b>ApiKey</b> - you will need your own Google API Key: 
        <ol>
        <li>
            Go to the <a href="https://console.cloud.google.com/">Google Cloud Console.</a>
            <li>Click the project drop-down and select or create the project for which you want to add an API key.</li>
            <li>Click the menu button and select <b>APIs & Services</b>. </li>
            <li>Click on the  <b>+ Enable APIs and services</b>. Search for Google Sheets, click on the search result -  <b>Enable</b>. Repeat the same process for Google Drive API (search and enable it as well).   </li>
            <li>Click the menu button again and select  <b>APIs & Services > Credentials</b>.  </li>
            <li>On the Credentials page, click <b>+ Create Credentials > API key</b>. You can optionally restrict it to Google Sheets API + Google Drive API only. </li>
            <li>Copy the newly created key and paste it in the <code>apiKey</code> field in your INIT button.</li>
            <button id="example" onclick="toggle_visibility('sheetsapikey')">Show video guide</button>
            <div id="sheetsapikey" style="display: none;"> <div class="video"><iframe 
                src="https://www.youtube.com/embed/JFtBLf44ONs?controls=1" allowfullscreen></iframe></div>
                </iframe><br></div></li>
        </li></ol>
        <li><b>itchKey</b> - key which was provided to you on the Itch.io purchase page. You can click on the purchase confirmation link that was sent to your email to retrieve it again. If you have any issues retrieving your key, please join our <a href="https://discord.gg/dXez8Zh"> Discord server</a> and ask for assistance or directly DM Christinna#9031. <br>
        <i>Note: This is a randomly generated key, which protects your anonymity, while allowing me to monitor any potential abuse of the extension, as the project quota is shared among all the extension users. </i>         
        </li>
        <li><b>ShowAlerts</b> - whether you want to show yellow notification messages for successful requests. If you set it to false, only errors are shown.</li>
        
         </li>
         <li>You can optionally fill out the <b>spreadsheetID</b> in Math:Change Variable command if you're going to use the extension only for one specific SpreadSheet. <p id="important"> Remember you must use Create Spreadsheet button first as this extension can only modify spreadsheets specifically created with it. The Spreadsheet also has to be made public (which the Create Spreadsheet button will do for you).</p><p>Spreadsheet ID can be retrieved by going to your spreadsheet in the browser and copying it from the URL: <code>https://docs.google.com/spreadsheets/d/YOURSPREADSHEETID/edit?usp=sharing</code></li> 
        </ul>
        <li><b>Configure OPTIONS button:</b> Inside the button you can choose which extension commands you wish to use and display in your Extension drop down menu (this is to prevent clutter as there are a lot of them). Select true to display it or false to hide it and press the button. <br> Default commands which are always displayed after pressing INIT button: Get Data, Append Data, Update Data, Batch Update, Find Data, Sort Range.</li>
        <li>Your basic setup is now done. You're ready to start using the extension! </li>   </ol>
        </div>
        <h4>Walkthrough</h4>
       <p>I have created a walkthrough with examples showing how to use the extension. <br> Please follow buttons number 1-15 in the specified order while looking at your spreadsheet and commands inside the button to see what they're doing to better understand how to use them. <br> Note: This walkthrough is intended for English version of sheets. You might need to modify some commands (such as your sheet name or button 5. where it adds months in English) for it to work for other languages. 
       
        <button id="example" onclick="toggle_visibility('walkthrough')">Show all steps</button> 
        <br> 

        <div id="walkthrough"  style="display:none">    
    
        <ol>
        <li><b>Create Spreadsheet</b> - we are starting with this button, because our extension can only modify spreadsheets we previously created with it. Go ahead and create Testing Spreadsheet. A new URL should open in your browser with your newly created spreadsheet (or you can go to <a href="https://docs.google.com/spreadsheets">https://docs.google.com/spreadsheets</a>). You need to make the <a href="https://i.imgur.com/JMjvPyX.mp4">spreadsheet public </a>, this extension can only work with public spreadsheets. We will work with this spreadsheet from now on, so keep it open to see what is happening when you press the next buttons. </li>       
        <li><b>Append by Value</b> - this command will append a few names to our sheet by using a single variable containing all the values. | separator marks one cell. </li>
        <li><b>Append by Stack</b> - you can also append values by stack. In our example we append some points to our previously created user names. </li>
        <li><b>Update by Value</b> - this is the same as Append by Value command, except it will override cells if they already contain values. In our example we update a cell with a formula that calculates the total amount of points of all the users and immediately returns the calculated value in a stack called 'updated'. This is to show that you can write simple values into your sheets, but also complex formulas! </li>
        <li><b>Update by Stack</b> - this is the same as Append by Stack command, except it will override cells if they already contain values. In our example we add some months to our list of users.</li>
        <li><b>Get Data</b> - this command simply retrieves data by range. We retrieve all users, their points and months by columns, which will be saved in 3 separate stacks: getData1 (containing names), getData2 (containing points) and getData3 (containing months). </li>
        <li><b>Find Data</b> - to look up an individual user, we can use find data command. In this case we're trying to look for Melonax within our usernames and we want to return the whole row. We want to know what her points and months are. All should be saved in foundData stack now. </li>
        <li><b>Sort Range</b> - we can sort the users by their points, starting from the one with the most amount of points.</li>
        <li><b>Auto Fill</b> - in our example we auto fill more months </li>
        <li><b>Find and Replace</b> - we search for 'ju' (in June and July) and replace it with 'SUMMER:'. Because why not. </li>
        <li><b>Split Text</b> - now that we have a called 'SUMMER:ne' and 'SUMMER:ly' from our previous command, we can split them into 4 spells, using : as delimiter.  </li>
        <li><b>Batch Update</b> - extremely useful command to update multiple ranges at once. In our example we add more users and their points to the list.</li>
        <li><b>Randomize</b> - we shuffle the points around and randomly assign them to our users. They will be surely happy about that... </li>
        <li><b>Clear Data</b> - now we will just clear all the points. Our users can start all over! </li>
        <li><b>Delete Duplicates</b> - as you might have noticed, we've got two Melonax entries in our user list. With this command we can easily find the duplicate one and delete it. </li>
        </ol>
       </div>
       <p><b>Walkthrough video</b> (no talking + the video is missing the step where you need to make the new spreadsheet public): <br>
       <iframe width="420" height="315"
       src="https://www.youtube.com/embed/LFNECMyehZo?controls=1" allowfullscreen>
       </iframe> <br> 
       
        <h4>Parameters</h4>
        <p>A lot of buttons share the same parameters, which are going to be skipped in the Buttons section below. 
         <br>   <button id="example" onclick="toggle_visibility('sheetparams')">Show all parameters</button>    
            <div id="sheetparams"  style="display:none"> 
        <ol>
        <li> <code>SpreadsheetID</code> - you can either fill it out manually for each button or set up spreadsheetID variable in your INIT button if you intend to use a single Spreadsheet. <br> 
        Spreadsheet ID can be retrieved by going to your spreadsheet in the browser and copying it from the URL: 'https://docs.google.com/spreadsheets/d/YOURSPREADSHEETID/edit?usp=sharing'</li>
        <li><code>SheetName</code> - name of the particular Sheet you want to Get or Edit data in. <Br>
         <b id="important">Important:</b> The extension automatically converts your sheet name to your sheet ID to make it easier to work with. If you rename a sheet to another sheet's name that previously existed in your SpreadSheet (i.e. Sheet1 becomes Sheet2 and Sheet2 becomes Sheet1), you must completely close and reopen Transmitter to reset your session. Otherwise it will still assign the old sheet ID to the name. 
        </li>
        <li><code>Range</code> - range you wish to Get or Edit data in, such as A1:B10.</li>
        <li><code>Dimension</code> - major dimension to Get or Edit data in. <br> For example, if you use the Get Data command and set the range to A1:B10 and your dimension to ROWS, it will return 10 stacks, each containing one row (first stack will be A1-B1 values, second one A2-B2 values, etc.). <br> If you change your dimension to COLUMNS, it will return 2 stacks, each containing 1 column (first stack will be A1-A10 values and second stack will have B1-B10 values). 
        </li>
   
        <li><code>Values</code>(applies to Append Data, Update Data and Batch Update commands) - you can send values to the extension in two different ways: 
        <ol>
        <li>A string of values separated by | marking individual cells. For example, if you want to insert values in A1:A7 range (make sure dimension is COLUMNS), you can enter them like this: <code>Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday</code>. Result: <br> <img src="https://i.imgur.com/Nv05PeI.png"></li>
        <li>A stringified stack. All values from the stack will be inserted into the selected range, starting from position 0 and ending with the last position. <br>
        <ol>
        <li>Create a stack with some entries.</li>
        <li>Use Stack: Stringify command.</li>
        <li>Use String: Replace command on the newly stringified stack. Replace <code>"</code> with <code>'</code></li>
        <li>Insert the stringified stack variable in the Values field.</li>
        </ol>
        <button id="example" onclick="toggle_visibility('appenddata')">Show example</button></p>
            <div id="appenddata"  style="display:none">     
        <img src="https://i.imgur.com/v5WZyWV.png"></div>
        </li>
        </ol>     
        </li>
        </ol></p></div>
        

      <p>  <H4>Buttons</H4>
        <button id="example" onclick="toggle_visibility('buttonssheet')">Show all buttons</button></p>
        <div id="buttonssheet"  style="display:none">     
        <p> <b>Append by value/stack</b> 
            <p>Appends values to a spreadsheet, either by a single variable or a stack. Must be either a single column or single row. 
                <br><button id="example" onclick="toggle_visibility('appenddataxx')">Expand</button></p>
            <div id="appenddataxx"  style="display:none">     
            <ul>
                <li><code>inputType</code> - How the data should be interpreted. Default is <a href="https://developers.google.com/sheets/api/reference/rest/v4/ValueInputOption">User Entered.</a> </li>
            <li><code>InsertType</code>How the input data should be <a href="https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets.values/append#InsertDataOption">inserted</a>.</li>
            <button id="example" onclick="toggle_visibility('sheetappend')">Show string column example</button>
            <button id="example" onclick="toggle_visibility('sheetappend2')">Show stack row example</button>
            <div id="sheetappend" style="display: none;"><img src="https://i.imgur.com/FgaAs16.png" /><br /></div></li>
            <div id="sheetappend2" style="display: none;"><img src="https://i.imgur.com/eKuBZYD.png" /><br /></div></li>
        
            </ul></div>
        
            <p> <b>Update Data</b>   
           <p> Same as Append Data command, except it will update (=overwrite) data in the selected range instead of appending them. <br>
            <p> <b>Batch Update</b>  <br> 
           <p> This is a very important button to understand if you want to perform update data batch requests. Instead of sending multiple single requests, use Batch Update button instead. <br> Please remember that you share write request quota with all other users using the extension, so try your best to group up your Update Data requests.<br>
            <button id="example" onclick="toggle_visibility('batchupdate')">Expand</button>    
            <div id="batchupdate"  style="display:none">     
           <ul><li><code>Amount</code> - amount of Update Data requests you're sending</li></ul>
             <ol>
            <li>Send 'Google Sheets Batch Update' command and specify the amount of requests.</li>
            <li>Send all your following Update Data requests as you normally would. <br></li>
            <li>The extension will queue them up and wait for the last request to send them all at once. If you fail to supply all requests within the next 10 seconds, the queue will be deleted and resetted. Simply said, either all requests are sent or none. </li>
            </ol>
           </div>
        
        
        <p> <b>Get Data</b> 
        <p> Retrieves data based on the range and dimension, and saves them into a stack. <br>
        <button id="example" onclick="toggle_visibility('getdata')">Expand</button>    
        <div id="getdata"  style="display:none">     
        <ul>
            <li><code>Render</code> - How values should be represented in the output. Default is <a href="https://developers.google.com/sheets/api/reference/rest/v4/ValueRenderOption">formatted value.</a></li>
        <li><code>Delete Empty</code> - whether to delete empty values before putting them into the stack. </li>
        <li><code>StackName</code> - base name of the stack for the retrieved data. For a base name 'My Stack' and request for data from 2 columns, you will get back 'My Stack1' and 'My Stack2' stacks, each containing 1 row of values. </li>
        
        <button id="example" onclick="toggle_visibility('sheetget')">Show example</button>
        <div id="sheetget" style="display: none;"><img src=" https://i.imgur.com/PKYyDdq.png" /><br /></div></li>
        </ul></div>
        
        <p> <b>Find Data</b> 
        <p>Matches a string/value to a cell in a single column or row and returns its coordinates + related values. Must be an exact match. Finds the first occurence only.  <br>
            <button id="example" onclick="toggle_visibility('finddata')">Expand</button>    
            <div id="finddata"  style="display:none">     
         <ul>
         <li><code>Range </code> -  range to search. Must be exactly one column or one row, i.e. A1:A10 or A1:K1.  </li>
         <li><code>find</code> -  string to find (must exactly match the cell contents, case sensitive) </li>
         <li><code>Dimension</code> - select COLUMNS or ROWS depending on whether your range is a column or row. </li>
         <li><code>Span</code> the span of the rows/columns to retrieve. If set to 0, the whole column/row is returned. If Span is set to 1:5, it will return row 1-5 if you search by column and column A-E if you search by row. </li>
         <li><code>Variable</code> - variable to save the cell's coordinates. A stack containing the returned row/column values will be also created (same name as the variable). </li>
        </ul></div>
        
        
        
        <p><b>Create SpreadSheet</b> </p>
        <p>Creates a new SpreadSheet. The extension can only modify spreadsheets specifically created with this command. <br>
            <button id="example" onclick="toggle_visibility('createspread')">Expand</button>    
            <div id="createspread"  style="display:none">     
        <p>You need to manually make the newly created spreadsheet <a href="https://i.imgur.com/JMjvPyX.mp4">public </a> <br>There will be a hidden sheet added to every spreadsheet you create. This sheet serves as sort of a look up sheet for Find Data command. Please don't delete or rename it.</p>
        <ul>
        <li><code>Title</code> - name for your new SpreadSheet</li>
        <li><code>Variable</code> - variable to save your new SpreadSheet ID into.</li>
        </ul> </div>
        
        
        <p><b>Duplicate Sheet</b> </p>
        <p>Duplicates an existing sheet. <br>
            <button id="example" onclick="toggle_visibility('dupsheet')">Expand</button>    
            <div id="dupsheet"  style="display:none">     
        <ul><li><code>SourceSheetName</code> - name of the sheet you wish to duplicate</li>
        <li><code>newSheetName</code> - name of the new duplicated sheet</li>
        <li><code>insertSheetIndex</code> - where in your SpreadSheet you want to insert the duplicated sheet</li></ul></div>
        <p><b>Add Sheet</b> </p>
        <p>Adds a new sheet to the selected SpreadSheet <br>
            <button id="example" onclick="toggle_visibility('addsheet')">Expand</button>    
            <div id="addsheet"  style="display:none">     
        <ul><li><code>Name</code> - name for your new sheet</li>
        <li><code>Index</code> - where in your SpreadSheet you want to insert the new sheet</li>
        <li><code>Hidden</code> - whether you want to make the sheet hidden</li>
        </ul></div>
        <p><b>Copy Paste</b> </p>
        <p>Copies data from the source to the destination <br>
        <button id="example" onclick="toggle_visibility('copypaste')">Expand</button>    
        <div id="copypaste"  style="display:none">     
        <ul> <li><code>Range</code> - source range to copy</li>
        <li><code>TargetSheet</code> - sheet name to paste the data to</li>
        <li><code>TargetRange</code> - range to paste the data to</li>
        <li><code>PasteType</code> - what kind of data to paste</li>
        <li><code>PasteOrientation</code> - how the pasted data should be oriented. Transpose = all rows become columns.</li>
        </ul></div>
        <p><b>Auto Fill</b> </p>
        <p>Fills in more data based on existing data.<br>
        <button id="example" onclick="toggle_visibility('autofill')">Expand</button>    
        <div id="autofill"  style="display:none">     
        <ul> <li><code>Range</code> - range to autofill.</li>
        <li><code>useAlternateSeries</code> - generate data with the "alternate" series. Differs based on the type and amount of data.</li></ul></div>
        <p><b>Find Replace</b> </p>
        <p>Finds and replaces data in cells over a selected range.<br>
        <button id="example" onclick="toggle_visibility('findreplace')">Expand</button>    
        <div id="findreplace"  style="display:none">     
        <ul><li><code>Range</code> - range to find/replace over </li>
        <li><code>Find</code> - value to search (string). <br> If you want to use regex, prefix the expression with 'regex'. Example: <b>find</b><code>regex o.* (.*)</code>, <b>replace</b> <code>"$1 Hello"</code> Your formatting must follow <a href="https://docs.oracle.com/javase/8/docs/api/java/util/regex/Pattern.html">Java regex rules.</a></li>
        <li><code>Replace</code> - value to use as the replacement</li>
        <li><code>matchCase</code> - true if the search is case sensitive</li>
        <li><code>matchEntireCell</code> -  true if the find value should match the entire cell</li></ul></div>
        <p><b>Split Text</b> </p>
        <p>Splits a column of text into multiple columns, based on a delimiter in each cell.<br>
        <button id="example" onclick="toggle_visibility('splitdata')">Expand</button>    
        <div id="splitdata"  style="display:none">     
        <ul><li><code>Range</code> - the source data range. This must span exactly one column.</li>
        <li><code>Delimiter</code> - the delimiter to use. For example <code>:</code>> or <code>,</code>>.</li></ul>
            </div>
        <p><b>Sort Range</b> </p>
        <p>Sorts data in rows based on a sort order per column.<br>
        <button id="example" onclick="toggle_visibility('sortdata')">Expand</button>    
        <div id="sortdata"  style="display:none">     
        <ul>
        <li><code>Range</code> - the range to sort</li>
        <li><code>sortOrder</code> - the order the data should be sorted.</li>
        <li><code>dimIndex</code> - the dimension index the sort should be applied to, for example <code>B</code> or <code>1</code> (which is the same as B).</li>
        </ul></div>
        
        <p><b>Randomize</b> </p>
        <p>Randomizes the order of the rows in a selected range.<br>
        <button id="example" onclick="toggle_visibility('randomize')">Expand</button>    
        <div id="randomize"  style="display:none">     
        <ul>
        <li><code>Range</code> - the range to randomize</li>
        </ul></div>
        <p><b>Merge Cells</b> </p>
        <p>Merges cells for row or column.<br>
        <button id="example" onclick="toggle_visibility('merge')">Expand</button>    
        <div id="merge"  style="display:none">     
        <ul> <li><code>Range</code> - the range of cells to merge</li>
        <li><code>mergeType</code> - how the cells should be merged. <br> MERGE_ALL creates a single merge from the range. <br>MERGE_COLUMNS will create a merge for each column in the range. MERGE_ROWS will create a merge for each row in the range.</li></ul></div>
        <p><b>Unmerge Cells</b> </p>
        <p>Unmerges cells in the given range.<br>
        <button id="example" onclick="toggle_visibility('unmerge')">Expand</button>    
        <div id="unmerge"  style="display:none">     
        <ul> <li><code>Range</code> - the range within which all cells should be unmerged. If the range spans multiple merges, all will be unmerged. The range must not partially span any merge.</li></ul></div>
        
        <p><b>Clear Data</b> </p>
        <p>Clears all data in the selected range. <br>
        <button id="example" onclick="toggle_visibility('cleardata')">Expand</button>    
        <div id="cleardata"  style="display:none">     
        <ul>
        <li><code>Range</code> - range to clear the data from. Example: A1:A10.</li>
        </ul></div>
        <p><b>Insert Range</b> </p>
        <p>Inserts cells into a range, shifting the existing cells over or down.<br>
        <button id="example" onclick="toggle_visibility('insertrange')">Expand</button>    
        <div id="insertrange"  style="display:none">     
        <ul><li><code>Range</code> - range to insert new cells into</li>
        <li><code>Shift</code> - dimension to be shifted when inserting cells. ROWS = shifted down. COLUMNS = shifted right.</li></ul></div>
        <p><b>Delete Range</b> </p> <p>Deletes a range. <br>
          <button id="example" onclick="toggle_visibility('deleterange')">Expand</button>    
        <div id="deleterange"  style="display:none">     
        <ul> <li><code>Range</code> - the range of cells to delete</li>
        <li><code>Shift</code> - ROWS = existing cells will be shifted upward, COLUMNS = cells will be shifted left</li></ul></div>
        <p><b>Delete Duplicates</b> </p>
        <p>Removes rows within this range that contain values in the specified columns that are duplicates of values in any previous row. Removes duplicates with different letter cases, formatting, or formulas.<br>
        <button id="example" onclick="toggle_visibility('deletedupl')">Expand</button>    
        <div id="deletedupl"  style="display:none">     
        <ul><li><code>Range</code> - the range to remove duplicates rows from.</li>
        <li><code>Dimension</code> -  dimension to analyze for duplicate values</li>
        <li><code>StartIndex</code> - The start (inclusive) of the span. The columns in the range to analyze for duplicate values.</li>
        <li><code>EndIndex</code> - The end (exclusive) of the span.  The columns in the range to analyze for duplicate values.</li></ul></div>
            </div>
                        
                  
                </section>
            </div>
        </div>
        <script>$(document.links).filter(function() {return this.hostname != window.location.hostname;}).attr('target', '_blank');</script>
    </body>
</html>
