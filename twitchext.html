<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="main.css" />
        <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
        <script src="main.js"></script>
        <title>Extensions | LioranBoard</title>
    </head>
    <body>
        <header>
            <div class="title">
                <h1><a style="color:white" href="https://lioranboard.ca/docs">PLEASE CONTINUE TO OUR NEW WEBSITE: lioranboard.ca/docs</a>
                </div>
            <div class="slide">
                <nav class="sidebar" id="sidebar">
                    <div class="scroller">
                        <dl>
                            <dt>
                                <a href="index.html"> About LioranBoard</a>
                            </dt>
                        </dl>

                        <dl>
                            <dt>
                                <a href="setup.html"> Basic Setup</a>
                            </dt>
                        </dl>

                        <dl>
                            <dt>
                                <a href="commands.html"> Commands</a>
                            </dt>
                        </dl>

                        <dl>
                            <dt>
                                <a href="faq.html"> FAQ</a>
                            </dt>
                        </dl>

                        <dl>
                            <dt>
                                <a href="extensions.html"  class="active"> Extensions</a>
                            </dt>
                            <dd>
                                <a class="sub-page" href="lbext.html">LioranBoard</a>
                            </dd>
                            <dd>
                                <a class="sub-page" href="twitchext.html"  class="active">Twitch</a>
                            </dd>

                            <dd>
                                <a href="#eventsub">
                                    Twitch EventSub Webhook
                                </a>
                            </dd>

                                   
                            <dd>
                                <a class="sub-page" href="externalext.html">External</a>
                            </dd>
                            


                        </dl>

                        <dl>
                            <dt>
                                <a href="troubleshooting.html"> Troubleshooting</a>
                            </dt>
                        </dl>
                        <dl>
                            <dt>
                                <a href="commissions.html"> Commissions</a>
                            </dt>
                        </dl>
                    </div>
                </nav>
            </div>
        </header>

        <div class="wrapper">
            <div class="main">
                <section class="doc-content">
                    <h2>Twitch Extensions</h2>
               <!--    <p>In progress... </p>
                   
                    <h3 id="getprofilepicture">Get Profile Picture</h3>
                    <p><b>Creator: </b>Exeldro<br>
                    <b>Download: <a href="https://discord.com/channels/699319482442711072/712274509389889618/712276497351573584">Discord Link</a></b><br>
                    <b>Description: </b>
                    Will return the whole url of the profile picture of any Twitch user. 
                    </p>
        

   
                    <h3 id="getviewercount">Get Viewer Count</h3>
                    <p><b>Creator: </b>Lioran<br>
                    <b>Download: <a href="https://discord.com/channels/699319482442711072/712274509389889618/725431093997600808">Discord Link</a></b><br>
                    <b>Description: </b>
                    </p>


                    <h3 id="getchannelgame">Get Channel Game</h3>
                    <p><b>Creator: </b>Silverlink<br>
                    <b>Download: <a href="https://discord.com/channels/699319482442711072/712274509389889618/769473722046218240">Discord Link</a></b><br>
                    <b>Description: </b>
                    </p>
           

                    <h3 id="getlatestsub">Get Latest Subscriber</h3>
                    <p><b>Creator: </b>Christinna<br>
                    <b>Download: <a href="https://discord.com/channels/699319482442711072/712274509389889618/753949869323845653">Discord Link</a></b><br>
                    <b>Description: </b>
                    </p>
         

                    <h3 id="getlatestfollower">Get Latest Follower</h3>
                    <p><b>Creator: </b>Christinna<br>
                    <b>Download: <a href="https://discord.com/channels/699319482442711072/712274509389889618/753949966703001641">Discord Link</a></b><br>
                    <b>Description: </b>
                    </p>
         


                    <h3 id="channelpoints">Channel Points API</h3>
                    <p><b>Creator: </b>Lioran<br>
                    <b>Download: <a href="https://discord.com/channels/699319482442711072/712274509389889618/780371214920056833">Discord Link</a></b><br>
                    <b>Description: </b>
                    </p>



                    <h3 id="createmarker">Create Marker</h3>
                    <p><b>Creator: </b>Christinna<br>
                    <b>Download: <a href="https://discord.com/channels/699319482442711072/712274509389889618/725431093997600808">Discord Link</a></b><br>
                    <b>Description: </b>
                    </p>
           


                    <h3 id="twitchgetclips">Twitch Get Clips</h3>
                    <p><b>Creator: </b>Christinna<br>
                    <b>Download: <a href="https://github.com/christinna9031/LB-Twitch-Get-Clips">Github Link</a></b><br>
                    <b>Description: </b>
                    </p>


                    <h3 id="clipit">Clip It (and post to Discord)</h3>
                    <p><b>Creator: </b>Christinna<br>
                    <b>Download: <a href="https://github.com/christinna9031/LB-Clip-It">Github Link</a></b><br>
                    <b>Description: </b>
                    </p>
  

                    <h3 id="getcliplength">Get Clip Length</h3>
                    <p><b>Creator: </b>Christinna<br>
                    <b>Download: <a href="https://github.com/christinna9031/LB-Twitch-Clip-Length">Github Link</a></b><br>
                    <b>Description: </b>
                    </p> -->  

                    <h3 id="eventsub">Twitch EventSub Webhook</h3>
                    <p><b>Creator: </b>Christina<br>
                    <b>Download: <a href="https://christinak.itch.io/lb-eventsub-webhook">Itch.io</a></b><br>
                    <b>Description: </b> Receive Twitch EventSub triggers in your LioranBoard. Followers, Polls, Predictions and Hype Train events are now functional! 
      
                    <h4>Setup:</h4>
                     <ol>
                     <li><a href="https://christinna9031.github.io/LBDocumentation/setup.html#extensions">Install the extension.</a> </li>
                     <li>Make sure you're logged into your main streaming account on <a href="https://www.twitch.tv/">Twitch</a> and <a href="https://christinna9031.github.io/LioranBoard-Files/eventsub_auth.html">authorize the extension</a>.
                     <li>Go to the premade deck and edit the <b>INIT button</b>: 
                        <ul>
                        <li><code>itchKey</code> - key you received when you purchased the extension on Itch.io. <br> If you did not receive your key, it should be in your purchase confirmation email. Contact Christinna#9031 on Discord if you're having any technical issues retrieving it.</li>
                        <li><code>channel_id</code> - your streaming account's channel ID. <br> 
                            <b>In step 1 you should have received your channel ID after authorizing the extension. Skip this step if you already filled it out.</b> <br>
                            If you haven't filled out your channel_id yet: 
                           <ul>
                            <li>Use a premade variable <code>/$channel_id$/</code> if your main LB account (= name of your board in the Receiver) is the same as your main Twitch account.</li>
                            <li>Use a /$YOURTWITCHUSERNAME_channelid$/ (i.e. /$lioran_channelid$/ - all lower case characters) variable if your main LB account is your alternate/bot Twitch account. </li></ul></li>
                        <b id="important">NOTE:</b> Do NOT use quotes in these parameter boxes.     </ul>
                        <li>Save the changes you made in the INIT button by pressing DONE twice. Refresh or close and reopen your Transmitter.</li>
                        <li>Once the extension successfully connects, you should see a yellow notification message in your Receiver: <code>EventSub connection opened! Listening for events.</code> <br> <i>Please note that if you fill out your channel_id in the INIT button wrong, the yellow message will still say it's listening for events (but for the wrong Twitch channel). It's up to you to make sure you're connected to the right one. </i> </li>
                                         </li>
                                         
             <p><b id="important">Remember that every time you edit the INIT button in your premade deck, you must reload Transmitter for it to take effect. </b></p>
                     </ol>  
               <p> <b id="important"> IMPORTANT: </b> <b> Do not share your itchKey or the websocket endpoint you're connecting to (it can be seen in the network tab when you press F12 in your browser). They should be kept private at all times. I do not take responsibility for any loss of data if you accidentally expose them to public. </b> 

             <p> You can check your Eventsub connection status in the Eventsub Webhook tab in your Transmitter. <br>
             You can also <b>replay recent events</b> and <b>send test triggers from the same tab</b>. <br> <img src="https://i.imgur.com/dFvNdmL.png"> </p>

             <h4>Follower Triggers:</h4>
             <p>Extension trigger for this event is <code>EventSub Follower</code> 
             The premade Follower button will be triggered every time you get a new follower. 
                Math Trigger Pull Values: 
                <ol>
                <li><b>Value 1</b> Display Name </li>
                <li><b>Value 2</b> Username </li>
                <li><b>Value 3</b> User ID </li>
                </ol>
            </p>

               <p> <h4>Polls Triggers:</h4>
                <p>There are triggers for poll begin, progress and ended. </p>
                <button id="example" onclick="toggle_visibility('pollstriggers')">Expand</button>    <div id="pollstriggers"  style="display:none">
               <p> Each time a new poll starts, there will be a stack <code>esPollChoice{CHOICE NUMBER}</code> created for each choice, i.e. esPollChoice1, esPollChoice2, esPollChoice3 etc. The stacks will be updated every time there's any change in votes. The stack contains: 
                <ol>
                <li><b>title [0]</b> - for example <Code>[0]esPollChoice1</Code> is a title for the first choice in the poll.</li>
                <li><b>choice ID [1]</b> - for example <Code>[1]esPollChoice1</Code> is the ID for the first choice in the poll.</li>
                <li><b>total votes [2]</b> - for example <Code>[2]esPollChoice1</Code> is the amount of total votes received for the first choice.</li>
                <li><b>channel point votes [3]</b> - for example <Code>[3]esPollChoice1</Code> is the amount of channel point votes received for the first choice. </li>
                <li><b>bits votes [4]</b> - for example <Code>[4]esPollChoice1</Code> is the amount of bits votes received for the first choice.</li>
                </ol> </p>
                <p><b class="btnbasic" id="btngreen">Poll Begin</b> </p>
                <p>Extension trigger for this event is <code>EventSub Poll Begin</code>. <br> 
                The premade button will be triggered every time you start a new poll. 
                Math Trigger Pull Values: 
                <ol>
                <li><b>Value 1</b> Title of the poll </li>
                <li><b>Value 2</b> Poll ID </li>
                <li><b>Value 3</b> Amount of choices in the poll </li>
                <li><b>Value 4</b> When the poll ends (timestamp) </li>
                <li><b>Value 5</b> Time remaining until the poll ends (in milliseconds) </li>
                </ol>
                </p>
                <p><b class="btnbasic" id="btnorange">Poll Progress</b> </p>
                <p>Extension trigger for this event is <code>EventSub Poll Progress</code>. <br> 
                The premade button will be triggered every time there's any change in the votes in the poll.
                Math Trigger Pull Values: 
                <ol>
                <li><b>Value 1</b> Title of the poll </li>
                <li><b>Value 2</b> Poll ID </li>
                <li><b>Value 3</b> Amount of choices in the poll </li>
                <li><b>Value 4</b> Total poll votes </li>
                <li><b>Value 5</b> When the poll ends (timestamp) </li>
                <li><b>Value 6</b> Time remaining until the poll ends (in milliseconds) </li>
                </ol>
                </p>
                <p><b class="btnbasic" id="btndarkblue">Poll End</b> </p>
                <p>Extension trigger for this event is <code>EventSub Poll End</code>. <br> 
                The premade button will be triggered once when the poll ends.
                Math Trigger Pull Values: 
                <ol>
                <li><b>Value 1</b> Title of the poll </li>
                <li><b>Value 2</b> Poll ID</li>
                <li><b>Value 3</b> Amount of choices in the poll </li>
                <li><b>Value 4</b> Total poll votes </li>
                <li><b>Value 5</b> When the poll ended (timestamp) </li>
                <li><b>Value 6</b> Winning choice:  </li>
                <ol>
                <li><b>Single Winner</b> - name of the stack that won the poll if there is a single winner, i.e. "esPollChoice1". Get its title, amount of votes etc. by peeking in the winning stack.  </li>
                <li><b>Draw</b> - if there are two or more choices with the same amount of votes, <b>value 6</b> will be "draw" and <b>value 7</b> will be the amount of winning choices with the same amount of votes. <br> There will be a new stack <code>esPollWinners</code> created containing all winning choices stack names. You can first peek into the stack to pull winners stack names and then peek into the individual stacks to pull title, amount of votes etc. 
                </li>
                </ol>
                </ol>
                </p>
                <p>  Poll Reset button which clears all variables and stacks will be triggered as well. If you do not wish to clear them, you can remove this command (all the way at the end).
            </div>
                <h4>Prediction Triggers:</h4>
                <p>There are triggers for Prediction begin, progress, lock and ended.</p>
                <button id="example" onclick="toggle_visibility('predtriggers')">Expand</button>    <div id="predtriggers"  style="display:none">
                <p> Each time a new prediction starts, there will be two stacks created for each outcome:<code>esOutcome1</code>  and <code>esOutcome2</code>. The stacks will be updated every time there's any change in votes. The stacks contain: 
                 <ol>
                 <li><b>title [0]</b>> - for example <Code>[0]esOutcome1</Code> is a title for the first outcome.</li>
                 <li><b>outcome ID [1]</b>> - for example <Code>[1]esOutcome1</Code> is the ID for the first outcome.</li>
                 <li><b>outcome color [2]</b> - for example <Code>[2]esOutcome1</Code> is the color for the first outcome.</li>
                 <li><b>users participating [3]</b>> - for example <Code>[3]esOutcome1</Code> is the amount of users who votes for the first outcome.</li>
                 <li><b>channel points used [4]</b>> - for example <Code>[4]esOutcome1</Code> is the amount of channel point votes used for the first outcome. </li>
                 </ol> </p>
                <p> There will be also two stacks created for each outcome predictors: <code>esOutcome1_predictors</code> and <code>esOutcome2_predictors</code>. Each predictor stack contains predictor objects: {name, login, id, points used, points won}. <br> 
                 How to parse the object to create a stack for a specific predictor: 
                <ol>
                <li>
                <b>Stack: Peek</b> Peek into the stack to retrieve the stringified object. 
                <li><b>String: Replace</b> Replace all single quotes for double quotes in the variable from Stack Peek.</li>
                <li><b>Stack: Parse String</b> Parse the stringified object into a new stack.</li>
                <li>The new predictor stack will contain:
                    <ol>
                        <li><b>name [0]</b> display name of the viewer</li>
                        <li><b>login [1]</b> username of the viewer</li>
                        <li><b>user ID [2]</b> user ID of the viewer</li>
                        <li><b>channel points used [3]</b> how many points the viewer used for the specific outcome </li>
                        <li><b>channel points won [4]</b> how many points the viewer won</li>
                    </ol>
                </li>

                </li>
                 </ol>

                <p> <i>Examples working with the stacks mentioned above can be found in the premade buttons.</i>



                 <p><b class="btnbasic" id="btngreen">Prediction Begin</b> </p>
                 <p>Extension trigger for this event is <code>EventSub Prediction Begin</code>. <br> 
                 The premade button will be triggered every time you start a new prediction.
                 Math Trigger Pull Values: 
                 <ol>
                 <li><b>Value 1</b> Title of the prediction </li>
                 <li><b>Value 2</b> Prediction ID </li>
                 <li><b>Value 3</b> Prediction locks at timestamp</li>
                 <li><b>Value 4</b> Time remaining until the prediction locks in milliseconds </li>
                 </ol>
                 </p>
                 <p><b class="btnbasic" id="btnorange">Prediction Progress</b> </p>
                 <p>Extension trigger for this event is <code>EventSub Prediction Progress</code>. <br> 
                 Math: Trigger pull values are the same as for Prediction Begin.
                 </p>
                 <p><b class="btnbasic" id="btnpurple">Prediction Lock</b> </p>
                 <p>Extension trigger for this event is <code>EventSub Prediction Lock</code>. <br> 
                 The premade button will be triggered once when the prediction locks.
                 Math Trigger Pull Values: 
                 <ol>
                    <li><b>Value 1</b> Title of the prediction </li>
                    <li><b>Value 2</b> Prediction ID </li>
                    <li><b>Value 3</b> Prediction locked at timestamp</li>
                    </ol>
                 <p><b class="btnbasic" id="btndarkblue">Prediction End</b> </p>
                 <p>Extension trigger for this event is <code>EventSub Prediction End</code>. <br> 
                 The premade button will be triggered once when the prediction ends (i.e. when the streamer selects the final outcome).
                 Math Trigger Pull Values: 
                 <ol>
                    <li><b>Value 1</b> Title of the prediction </li>
                    <li><b>Value 2</b> Prediction ID </li>
                    <li><b>Value 3</b> Prediction locked at timestamp</li>
                    <li><b>Value 4</b> Prediction winning outcome - name of the stack. Will be either "esOutcome1" or "esOutcome2". You can peek into the stack to pull its title, users participating, points used etc. </li>
                    </ol>
                <p> Prediction Reset button which clears all variables and stacks will be triggered as well. If you do not wish to clear them, you can remove this command (all the way at the end).
                 </p>
                </div>

                 <h4>Hype Train Triggers:</h4>
                 <p>There are triggers for Hype Train begin, progress and ended.</p>
                 <button id="example" onclick="toggle_visibility('hypetriggers')">Expand</button>    <div id="hypetriggers"  style="display:none">
                 <p> Each time a new Hype Train starts, there will be a maximum of two stacks created: <code>esHypeTop1</code> and <code>esHypeTop2</code>. One stack is for top bits contributor and one stack is for top subscription contributor. Make sure to check the size of esHypeTop2 stack, as there might not always be both stacks created (if you get only subscribers but no bits, there will be no bit stack). Each stack contains: 
        
                  <ol>
                  <li><b>display name [0]</b> - for example <Code>[0]esHypeTop1</Code> is the top contributor's display name.</li>
                  <li><b>login name [1]</b> - for example <Code>[1]esHypeTop1</Code> is the top contributor's login name.</li>
                  <li><b>user ID [2]</b> - for example <Code>[2]esHypeTop1</Code> is the top contributor's user ID.</li>
                  <li><b>type [3]</b> - for example <Code>[3]esHypeTop1</Code> is the top contributor's type of contribution. Will be either sub or bits. </li>
                  <li><b>total points [4]</b> - for example <Code>[4]esHypeTop1</Code> is the the top contributor's total points used. </li>
                  </ol> </p>
             
 
                  <p><b class="btnbasic" id="btngreen">Hype Train Begin</b> </p>
                  <p>Extension trigger for this event is <code>EventSub Hype Train Begin</code>. <br> 
                  The premade button will be triggered every time a new Hype Train begins.
                  Math Trigger Pull Values: 
                  <ol>
                  <li><b>Value 1</b> Hype Train ID </li>
                  <li><b>Value 2</b> Total points contributed to the Hype Train </li>
                  <li><b>Value 3</b> The current level of the Hype Train.</li>
                  <li><b>Value 4</b> The number of points contributed to the Hype Train at the current level </li>
                  <li><b>Value 5</b> The number of points required to reach the next level </li>
                  <li><b>Value 6</b> The time when the Hype Train expires (timestamp) </li>
                  <li><b>Value 7</b> Most recent contributor's viewer name. </li>
                  <li><b>Value 8</b> Most recent contributor's login. </li>
                  <li><b>Value 9</b> Most recent contributor's user ID. </li>
                  <li><b>Value 10</b> Most recent contribution type (bits or subscription). </li>
                  <li><b>Value 11</b> Total contributed (for the last contribution) </li>
                  <li><b>Value 12</b> Time remaining until Hype Train expires (in milliseconds) </li>
                  </ol>
                  </p>
                  <p><b class="btnbasic" id="btnorange">Hype Train Progress</b> </p>
                  <p>Extension trigger for this event is <code>EventSub Hype Train Progress</code>. <br> 
                    The premade button will be triggered every time there's a progress in Hype Train. <br>
                  Math: Trigger pull values are the same as for Hype Train Begin.
                  </p>
                  <p><b class="btnbasic" id="btndarkblue">Hype Train End</b> </p>
                  <p>Extension trigger for this event is <code>EventSub Hype Train End</code>. <br> 
                  The premade button will be triggered once when the Hype Train ends.
                  Math Trigger Pull Values: 
                  <ol>
                    <li><b>Value 1</b> Hype Train ID </li>
                    <li><b>Value 2</b> Total points contributed to the Hype Train </li>
                    <li><b>Value 3</b> The current level of the Hype Train.</li>
                    <li><b>Value 4</b> Time when the Hype Train ended. </li>
                    <li><b>Value 5</b> Time when the Hype Train cooldown ends so that the next Hype Train can start. </li>
                    <li><b>Value 6</b> Time remaining until Hype cooldown ends (in milliseconds). </li>
                     </ol>
                     <p> Hype Train Reset button which clears all variables and stacks will be triggered as well. If you do not wish to clear them, you can remove this command (all the way at the end).
                </p>
            </div>

            <h4>Troubleshooting</h4>
            <p>Considering the extension relies on an external server acting as a relay between Twitch and LioranBoard, there might be some downtimes for hot fixes or updates in the early stages. You will be alerted of any upcoming maintenance via yellow notification message in your Receiver and in your browser's console log. </p>
            <p><b>If you happen to not receive any alerts for longer periods of time, please follow these steps: </b></p>
            <ol>
            <li>Check you're connected. In your <b>Transmitter</b>, go to Eventsub Webhook tab. The status should say <b>connected</b></li>
            <li>Check your <b>itchKey</b> in the INIT button. Do not wrap it in the quotes and make sure you copied the whole thing. If you do not remember or lost your key, go to the download link that was sent to your email from Itch after you purchased the extension. <br> If you shared or accidentally leaked your key, it might have been revoked. Please contact Christinna#9031 on Discord. </li>
            <li>Double check your <b>channel ID</b> in the INIT button, it has to be the same one you authorized in Setup step 1. Your channel ID is NOT your channel name, it's a string of numbers. One of the easy methods to retrieve it is using the Get Channel ID default extension. </li>
            <li> Verify your <b>subscription is active</b>: 
                <ol>
                <li>
                    Go to the <a href="https://christinna9031.github.io/LioranBoard-Files/eventsub_auth.html">authorization page </a> and reauthorize the app. Make sure you checked all the events you wish to listen to and authorize it again. 
                </li>
                <li>
                    Upon <b>successful authorization</b>, you should see a log it generated, it will say "Subscription already exists", which means the subscription has been successfully activated the first time you authorized it. If you see any other errors, please contact Christinna#9031 on Discord.
                    <button id="example" onclick="toggle_visibility('eventsubtroubleshoot2')">Show example</button>
                    <div id="eventsubtroubleshoot2" style="display: none;"><img src="https://i.imgur.com/x8MaMXX.png" /><br /></div>    
                </li>
                </ol>
            <li>If all the steps above did not help you, please go to your <b>Transmitter</b>, reload it and make sure it's connected to the Receiver. Go to the Eventsub Webhooks tab and double check the status says <b>connected</b>. You can now <b>Enable Message Logging</b>, which should log all the Eventsub events from Twitch (you need to reenable it if you reload Transmitter again). Give it some time to log some messages (try to run a test poll or prediction on your channel) and send me the log from each tab. <br> 
            </li>
            </ol>

            
                  
                </section>
            </div>
        </div>
    </body>
    <script>$(document.links).filter(function() {return this.hostname != window.location.hostname;}).attr('target', '_blank');</script>
</html>
